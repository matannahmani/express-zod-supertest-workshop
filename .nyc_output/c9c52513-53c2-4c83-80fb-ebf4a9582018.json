{"/home/matan/code/workshops/sep23/express/app.ts":{"path":"/home/matan/code/workshops/sep23/express/app.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":21}},"4":{"start":{"line":7,"column":20},"end":{"line":7,"column":59}},"5":{"start":{"line":8,"column":16},"end":{"line":8,"column":51}},"6":{"start":{"line":9,"column":13},"end":{"line":9,"column":37}},"7":{"start":{"line":10,"column":15},"end":{"line":10,"column":49}},"8":{"start":{"line":11,"column":13},"end":{"line":11,"column":37}},"9":{"start":{"line":12,"column":0},"end":{"line":12,"column":26}},"10":{"start":{"line":13,"column":0},"end":{"line":13,"column":39}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":46}},"12":{"start":{"line":15,"column":0},"end":{"line":15,"column":44}},"13":{"start":{"line":16,"column":0},"end":{"line":16,"column":44}},"14":{"start":{"line":17,"column":0},"end":{"line":19,"column":3}},"15":{"start":{"line":18,"column":4},"end":{"line":18,"column":48}},"16":{"start":{"line":20,"column":0},"end":{"line":22,"column":3}},"17":{"start":{"line":21,"column":4},"end":{"line":21,"column":160}},"18":{"start":{"line":23,"column":0},"end":{"line":23,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":17,"column":28},"end":{"line":17,"column":29}},"loc":{"start":{"line":17,"column":54},"end":{"line":19,"column":1}},"line":17},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":27},"end":{"line":20,"column":28}},"loc":{"start":{"line":20,"column":39},"end":{"line":22,"column":1}},"line":20}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":3,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":0,"16":1,"17":1,"18":1},"f":{"0":3,"1":0,"2":1},"b":{"0":[1,1,1],"1":[0,3],"2":[3,3]},"inputSourceMap":{"version":3,"file":"/home/matan/code/workshops/sep23/express/app.ts","sources":["/home/matan/code/workshops/sep23/express/app.ts"],"names":[],"mappings":";;;;;;AAAA,4DAAqC;AACrC,oDAAmE;AACnE,sCAA2C;AAC3C,kDAA4B;AAC5B,sCAA2C;AAC3C,gBAAM,CAAC,MAAM,EAAE,CAAC;AACH,QAAA,GAAG,GAAG,IAAA,iBAAO,GAAE,CAAC;AAC7B,WAAG,CAAC,GAAG,CAAC,qBAAU,CAAC,IAAI,EAAE,CAAC,CAAC;AAC3B,WAAG,CAAC,GAAG,CAAC,OAAO,EAAC,iBAAU,CAAC,CAAC;AAE5B,WAAG,CAAC,GAAG,CAAC,OAAO,EAAC,iBAAU,CAAC,CAAA;AAE3B,WAAG,CAAC,GAAG,CAAC,UAAU,EAAE,UAAC,GAAY,EAAE,GAAa,EAAE,IAAkB;IAChE,GAAG,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,oBAAoB,EAAE,CAAC,CAAC;AAChD,CAAC,CAAC,CAAC;AAEH,WAAG,CAAC,MAAM,CAAC,MAAM,EAAE;IACf,OAAO,CAAC,GAAG,CAAC,8IAIf,CAAC,CAAC;AACH,CAAC,CAAC,CAAC;AAEH,kBAAe,WAAG,CAAC","sourcesContent":["import bodyParser from 'body-parser';\nimport express, { Request, Response, NextFunction } from 'express';\nimport { userRouter } from './routes/user';\nimport dotenv from 'dotenv';\nimport { authRouter } from './routes/auth';\ndotenv.config();\nexport const app = express();\napp.use(bodyParser.json());\napp.use('/user',userRouter);\n\napp.use('/auth',authRouter)\n\napp.get('/welcome', (req: Request, res: Response, next: NextFunction) => {\n    res.json({ message: 'Welcome to the API' });\n});\n\napp.listen('7000', () => {\n    console.log(`\n  ################################################\n  Server listening on port: 7000\n  ################################################\n`);\n});\n\nexport default app;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"253687162fb7f77aa31e8eb244f7f9f166c13747","contentHash":"f0f7bcda479168cdc80fd57205c2cabf0ef4e26e72b240dd8ee5d5e1f49860c1"},"/home/matan/code/workshops/sep23/express/routes/user.ts":{"path":"/home/matan/code/workshops/sep23/express/routes/user.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":28}},"4":{"start":{"line":7,"column":16},"end":{"line":7,"column":51}},"5":{"start":{"line":8,"column":13},"end":{"line":8,"column":38}},"6":{"start":{"line":9,"column":13},"end":{"line":9,"column":39}},"7":{"start":{"line":10,"column":0},"end":{"line":10,"column":28}},"8":{"start":{"line":11,"column":0},"end":{"line":19,"column":3}},"9":{"start":{"line":12,"column":15},"end":{"line":12,"column":89}},"10":{"start":{"line":12,"column":52},"end":{"line":12,"column":86}},"11":{"start":{"line":13,"column":4},"end":{"line":18,"column":5}},"12":{"start":{"line":14,"column":8},"end":{"line":14,"column":23}},"13":{"start":{"line":17,"column":8},"end":{"line":17,"column":60}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":19},"end":{"line":11,"column":20}},"loc":{"start":{"line":11,"column":39},"end":{"line":19,"column":1}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":12,"column":34},"end":{"line":12,"column":35}},"loc":{"start":{"line":12,"column":50},"end":{"line":12,"column":88}},"line":12}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":13,"column":4},"end":{"line":18,"column":5}},"type":"if","locations":[{"start":{"line":13,"column":4},"end":{"line":18,"column":5}},{"start":{"line":13,"column":4},"end":{"line":18,"column":5}}],"line":13}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":2,"10":102,"11":2,"12":1,"13":1},"f":{"0":1,"1":2,"2":102},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[1,1]},"inputSourceMap":{"version":3,"file":"/home/matan/code/workshops/sep23/express/routes/user.ts","sources":["/home/matan/code/workshops/sep23/express/routes/user.ts"],"names":[],"mappings":";;;;;;AAAA,oDAAqD;AACrD,uCAAwC;AAExC,IAAM,MAAM,GAAG,iBAAO,CAAC,MAAM,EAAE,CAAC;AAYd,4BAAU;AAT5B,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,UAAC,GAAY,EAAE,GAAa;IAC3C,IAAM,IAAI,GAAG,aAAM,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,GAAG,KAAK,GAAG,CAAC,MAAM,CAAC,EAAE,EAA1B,CAA0B,CAAC,CAAC;IAC7D,IAAI,IAAI,EAAE;QACN,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAClB;SAAM;QACH,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,gBAAgB,EAAE,CAAC,CAAC;KACvD;AACL,CAAC,CAAC,CAAC","sourcesContent":["import express, { Request, Response } from 'express';\nimport { UserDB } from '../models/User';\n\nconst router = express.Router();\n\n\nrouter.get('/:id', (req: Request, res: Response) => {\n    const user = UserDB.find(user => user._id === req.params.id);\n    if (user) {\n        res.json(user);\n    } else {\n        res.status(404).json({ message: 'User not found' });\n    }\n});\n\nexport {router as userRouter};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"80869fab44f46472179f6c36696524795a94686e","contentHash":"5c68f3371e9f4becd43db4e0920bc10560b1556ef0e03f5f1664b42c912cf5ed"},"/home/matan/code/workshops/sep23/express/models/User.ts":{"path":"/home/matan/code/workshops/sep23/express/models/User.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":42}},"4":{"start":{"line":7,"column":12},"end":{"line":7,"column":26}},"5":{"start":{"line":8,"column":14},"end":{"line":8,"column":40}},"6":{"start":{"line":9,"column":15},"end":{"line":9,"column":32}},"7":{"start":{"line":10,"column":21},"end":{"line":10,"column":61}},"8":{"start":{"line":11,"column":0},"end":{"line":15,"column":12}},"9":{"start":{"line":16,"column":20},"end":{"line":20,"column":1}},"10":{"start":{"line":17,"column":4},"end":{"line":19,"column":42}},"11":{"start":{"line":21,"column":23},"end":{"line":25,"column":1}},"12":{"start":{"line":22,"column":15},"end":{"line":22,"column":49}},"13":{"start":{"line":23,"column":4},"end":{"line":23,"column":23}},"14":{"start":{"line":24,"column":4},"end":{"line":24,"column":49}},"15":{"start":{"line":26,"column":0},"end":{"line":35,"column":3}},"16":{"start":{"line":27,"column":19},"end":{"line":27,"column":94}},"17":{"start":{"line":28,"column":4},"end":{"line":34,"column":6}},"18":{"start":{"line":32,"column":45},"end":{"line":32,"column":86}},"19":{"start":{"line":33,"column":37},"end":{"line":33,"column":72}},"20":{"start":{"line":36,"column":0},"end":{"line":36,"column":15}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":20},"end":{"line":16,"column":21}},"loc":{"start":{"line":16,"column":34},"end":{"line":20,"column":1}},"line":16},"2":{"name":"(anonymous_2)","decl":{"start":{"line":21,"column":23},"end":{"line":21,"column":24}},"loc":{"start":{"line":21,"column":50},"end":{"line":25,"column":1}},"line":21},"3":{"name":"(anonymous_3)","decl":{"start":{"line":26,"column":44},"end":{"line":26,"column":45}},"loc":{"start":{"line":26,"column":60},"end":{"line":35,"column":1}},"line":26},"4":{"name":"(anonymous_4)","decl":{"start":{"line":32,"column":26},"end":{"line":32,"column":27}},"loc":{"start":{"line":32,"column":43},"end":{"line":32,"column":88}},"line":32},"5":{"name":"(anonymous_5)","decl":{"start":{"line":33,"column":23},"end":{"line":33,"column":24}},"loc":{"start":{"line":33,"column":35},"end":{"line":33,"column":74}},"line":33}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":100,"17":100,"18":1,"19":1,"20":1},"f":{"0":1,"1":1,"2":1,"3":100,"4":1,"5":1},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/home/matan/code/workshops/sep23/express/models/User.ts","sources":["/home/matan/code/workshops/sep23/express/models/User.ts"],"names":[],"mappings":";;;;;;AAAA,2BAAwB;AACxB,yCAAwC;AACxC,iCAAoC;AACpC,8DAA+B;AAElB,QAAA,OAAO,GAAG,OAAC,CAAC,MAAM,CAAC;IAC5B,GAAG,EAAE,OAAC,CAAC,MAAM,EAAE;IACf,IAAI,EAAE,OAAC,CAAC,MAAM,EAAE;IAChB,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;CACvB,CAAC,CAAC,MAAM,EAAE,CAAC;AAOZ,IAAM,aAAa,GAAG,UAAC,EAAe;IAClC,OAAO,sBAAG,CAAC,IAAI,CAAC;QACZ,GAAG,EAAE,EAAE;KACV,EAAE,UAAG,OAAO,CAAC,GAAG,CAAC,UAAU,CAAE,CAAC,CAAC;AACpC,CAAC,CAAA;AAED,IAAM,gBAAgB,GAAG,UAAC,QAAgB,EAAE,KAAa;IACrD,IAAM,IAAI,GAAG,IAAA,mBAAU,EAAC,QAAQ,CAAC,CAAC;IAClC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IACnB,OAAO,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,KAAK,QAAQ,CAAC;AACjD,CAAC,CAAA;AAEY,QAAA,MAAM,GAAW,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,UAAC,CAAC,EAAE,CAAC;IAC1D,IAAM,QAAQ,GAAG,IAAA,mBAAU,EAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,CAAA;IAC9E,OAAO;QACP,GAAG,EAAE,CAAC,CAAC,QAAQ,EAAE;QACjB,QAAQ,UAAA;QACR,IAAI,EAAE,aAAK,CAAC,IAAI,CAAC,SAAS,EAAE;QAC5B,gBAAgB,EAAE,UAAC,KAAa,IAAK,OAAA,gBAAgB,CAAC,QAAQ,EAAE,KAAK,CAAC,EAAjC,CAAiC;QACtE,aAAa,EAAE,cAAM,OAAA,aAAa,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,EAA3B,CAA2B;KAC/C,CAAA;AACL,CAAC,CAAC,CAAC;AACH,cAAM,CAAA","sourcesContent":["import { z } from 'zod';\nimport { faker } from '@faker-js/faker';\nimport { createHash } from 'crypto';\nimport jwt from 'jsonwebtoken';\n\nexport const UserZod = z.object({\n    _id: z.string(),\n    name: z.string(),\n    password: z.string(),\n}).strict();\n\nexport type User = z.infer<typeof UserZod> & {\n    validatePassword: (password: string) => boolean;\n    generateToken: () => string;\n};\n\nconst generateToken = (id: User['_id']) => {\n    return jwt.sign({\n        _id: id\n    }, `${process.env.JWT_SECRET}`);\n}\n\nconst validatePassword = (password: string, input: string) => {\n    const hash = createHash('sha256');\n    hash.update(input);\n    return hash.digest('base64url') === password;\n}\n\nexport const UserDB: User[] = new Array(100).fill(0).map((_, i) => {\n    const password = createHash('sha256').update(i.toString()).digest('base64url')\n    return {\n    _id: i.toString(),\n    password,\n    name: faker.name.firstName(),\n    validatePassword: (input: string) => validatePassword(password, input),\n    generateToken: () => generateToken(i.toString()),\n    }\n});\nUserDB"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f799fae52d0ac5f727f2e58d0758dc9078f9d32d","contentHash":"c2c729f0f4b346c6ea5bbcd22e4de3e89e5ac1b5863575235e8847d414a80776"},"/home/matan/code/workshops/sep23/express/routes/auth.ts":{"path":"/home/matan/code/workshops/sep23/express/routes/auth.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":28}},"4":{"start":{"line":7,"column":16},"end":{"line":7,"column":51}},"5":{"start":{"line":8,"column":28},"end":{"line":8,"column":73}},"6":{"start":{"line":9,"column":12},"end":{"line":9,"column":26}},"7":{"start":{"line":10,"column":13},"end":{"line":10,"column":38}},"8":{"start":{"line":11,"column":13},"end":{"line":11,"column":39}},"9":{"start":{"line":12,"column":0},"end":{"line":12,"column":28}},"10":{"start":{"line":13,"column":0},"end":{"line":15,"column":3}},"11":{"start":{"line":14,"column":4},"end":{"line":14,"column":23}},"12":{"start":{"line":16,"column":19},"end":{"line":19,"column":11}},"13":{"start":{"line":20,"column":0},"end":{"line":34,"column":3}},"14":{"start":{"line":21,"column":15},"end":{"line":21,"column":47}},"15":{"start":{"line":22,"column":4},"end":{"line":23,"column":65}},"16":{"start":{"line":23,"column":8},"end":{"line":23,"column":65}},"17":{"start":{"line":24,"column":15},"end":{"line":24,"column":24}},"18":{"start":{"line":25,"column":15},"end":{"line":25,"column":84}},"19":{"start":{"line":25,"column":52},"end":{"line":25,"column":81}},"20":{"start":{"line":26,"column":4},"end":{"line":28,"column":5}},"21":{"start":{"line":27,"column":8},"end":{"line":27,"column":67}},"22":{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},"23":{"start":{"line":30,"column":8},"end":{"line":30,"column":69}},"24":{"start":{"line":32,"column":16},"end":{"line":32,"column":36}},"25":{"start":{"line":33,"column":4},"end":{"line":33,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":61},"end":{"line":13,"column":62}},"loc":{"start":{"line":13,"column":81},"end":{"line":15,"column":1}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":22},"end":{"line":20,"column":23}},"loc":{"start":{"line":20,"column":42},"end":{"line":34,"column":1}},"line":20},"3":{"name":"(anonymous_3)","decl":{"start":{"line":25,"column":34},"end":{"line":25,"column":35}},"loc":{"start":{"line":25,"column":50},"end":{"line":25,"column":83}},"line":25}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":65}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":65}},{"start":{"line":22,"column":4},"end":{"line":23,"column":65}}],"line":22},"4":{"loc":{"start":{"line":26,"column":4},"end":{"line":28,"column":5}},"type":"if","locations":[{"start":{"line":26,"column":4},"end":{"line":28,"column":5}},{"start":{"line":26,"column":4},"end":{"line":28,"column":5}}],"line":26},"5":{"loc":{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},{"start":{"line":29,"column":4},"end":{"line":31,"column":5}}],"line":29}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":1,"18":1,"19":2,"20":1,"21":0,"22":1,"23":0,"24":1,"25":1},"f":{"0":1,"1":1,"2":1,"3":2},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[0,1],"4":[0,1],"5":[0,1]},"inputSourceMap":{"version":3,"file":"/home/matan/code/workshops/sep23/express/routes/auth.ts","sources":["/home/matan/code/workshops/sep23/express/routes/auth.ts"],"names":[],"mappings":";;;;;;AAAA,oDAAqD;AACrD,0EAAyE;AACzE,2BAAwB;AACxB,uCAAwC;AAExC,IAAM,MAAM,GAAG,iBAAO,CAAC,MAAM,EAAE,CAAC;AA4Bd,4BAAU;AA1B5B,MAAM,CAAC,GAAG,CAAC,KAAK,EAAC,yCAAmB,EAAE,UAAC,GAAY,EAAE,GAAa;IAC9D,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACvB,CAAC,CAAC,CAAC;AAGH,IAAM,YAAY,GAAG,OAAC,CAAC,MAAM,CAAC;IAC1B,GAAG,EAAE,OAAC,CAAC,MAAM,EAAE;IACf,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;CACvB,CAAC,CAAC,MAAM,EAAE,CAAC;AAEZ,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAC,GAAY,EAAE,GAAa;IAC9C,IAAM,IAAI,GAAG,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAC9C,IAAI,CAAC,IAAI,CAAC,OAAO;QACjB,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,cAAc,EAAE,CAAC,CAAC;IAClD,IAAA,IAAI,GAAI,IAAI,KAAR,CAAS;IACpB,IAAM,IAAI,GAAG,aAAM,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,GAAG,KAAK,IAAI,CAAC,GAAG,EAArB,CAAqB,CAAC,CAAC;IACxD,IAAI,CAAC,IAAI,EAAE;QACP,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,gBAAgB,EAAE,CAAC,CAAC;KAC9D;IACD,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;QACvC,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,kBAAkB,EAAE,CAAC,CAAC;KAChE;IACD,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;IACnC,GAAG,CAAC,IAAI,CAAC,EAAE,KAAK,OAAA,EAAE,CAAC,CAAC;AACxB,CAAC,CAAC,CAAC","sourcesContent":["import express, { Request, Response } from 'express';\nimport { authenticateRequest } from '../middlewares/authenticateRequest';\nimport { z } from 'zod';\nimport { UserDB } from '../models/User';\n\nconst router = express.Router();\n\nrouter.get('/me',authenticateRequest, (req: Request, res: Response) => {\n    res.json(req.user);\n});\n\n\nconst loginBodyZod = z.object({\n    _id: z.string(),\n    password: z.string()\n}).strict();\n\nrouter.post('/login', (req: Request, res: Response) => {\n    const body = loginBodyZod.safeParse(req.body);\n    if (!body.success)\n    return res.status(400).json({ message: 'Invalid body' });\n    const {data} = body;\n    const user = UserDB.find(user => user._id === data._id);\n    if (!user) {\n        return res.status(404).json({ message: 'User not found' });\n    }\n    if (!user.validatePassword(data.password)) {\n        return res.status(401).json({ message: 'Invalid password' });\n    }\n    const token = user.generateToken();\n    res.json({ token });\n});\n\nexport {router as authRouter};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"01416aa758249673190521f2e8b521ed0e28989c","contentHash":"41c8ddce3429edcb9a5201c7fd6dc7ef45cb1e486ed7bfa3912d35d4e8700124"},"/home/matan/code/workshops/sep23/express/middlewares/authenticateRequest.ts":{"path":"/home/matan/code/workshops/sep23/express/middlewares/authenticateRequest.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":22},"end":{"line":40,"column":1}},"67":{"start":{"line":39,"column":4},"end":{"line":39,"column":62}},"68":{"start":{"line":41,"column":0},"end":{"line":41,"column":62}},"69":{"start":{"line":42,"column":0},"end":{"line":42,"column":37}},"70":{"start":{"line":43,"column":21},"end":{"line":43,"column":61}},"71":{"start":{"line":44,"column":13},"end":{"line":44,"column":38}},"72":{"start":{"line":45,"column":26},"end":{"line":83,"column":5}},"73":{"start":{"line":45,"column":54},"end":{"line":83,"column":3}},"74":{"start":{"line":47,"column":4},"end":{"line":82,"column":7}},"75":{"start":{"line":48,"column":8},"end":{"line":81,"column":9}},"76":{"start":{"line":50,"column":16},"end":{"line":50,"column":50}},"77":{"start":{"line":51,"column":16},"end":{"line":51,"column":30}},"78":{"start":{"line":52,"column":16},"end":{"line":52,"column":29}},"79":{"start":{"line":54,"column":16},"end":{"line":54,"column":43}},"80":{"start":{"line":55,"column":16},"end":{"line":55,"column":52}},"81":{"start":{"line":55,"column":28},"end":{"line":55,"column":52}},"82":{"start":{"line":56,"column":16},"end":{"line":56,"column":99}},"83":{"start":{"line":58,"column":16},"end":{"line":58,"column":38}},"84":{"start":{"line":59,"column":16},"end":{"line":59,"column":85}},"85":{"start":{"line":60,"column":16},"end":{"line":60,"column":95}},"86":{"start":{"line":60,"column":60},"end":{"line":60,"column":91}},"87":{"start":{"line":61,"column":16},"end":{"line":64,"column":17}},"88":{"start":{"line":62,"column":20},"end":{"line":62,"column":36}},"89":{"start":{"line":63,"column":20},"end":{"line":63,"column":33}},"90":{"start":{"line":65,"column":16},"end":{"line":65,"column":29}},"91":{"start":{"line":66,"column":20},"end":{"line":66,"column":44}},"92":{"start":{"line":68,"column":16},"end":{"line":68,"column":34}},"93":{"start":{"line":69,"column":16},"end":{"line":69,"column":35}},"94":{"start":{"line":70,"column":16},"end":{"line":70,"column":30}},"95":{"start":{"line":71,"column":16},"end":{"line":71,"column":40}},"96":{"start":{"line":73,"column":16},"end":{"line":78,"column":17}},"97":{"start":{"line":74,"column":20},"end":{"line":74,"column":27}},"98":{"start":{"line":77,"column":20},"end":{"line":77,"column":70}},"99":{"start":{"line":79,"column":16},"end":{"line":79,"column":42}},"100":{"start":{"line":80,"column":20},"end":{"line":80,"column":42}},"101":{"start":{"line":84,"column":0},"end":{"line":84,"column":50}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"(anonymous_13)","decl":{"start":{"line":38,"column":56},"end":{"line":38,"column":57}},"loc":{"start":{"line":38,"column":71},"end":{"line":40,"column":1}},"line":38},"14":{"name":"(anonymous_14)","decl":{"start":{"line":45,"column":26},"end":{"line":45,"column":27}},"loc":{"start":{"line":45,"column":52},"end":{"line":83,"column":5}},"line":45},"15":{"name":"(anonymous_15)","decl":{"start":{"line":45,"column":95},"end":{"line":45,"column":96}},"loc":{"start":{"line":45,"column":107},"end":{"line":83,"column":1}},"line":45},"16":{"name":"(anonymous_16)","decl":{"start":{"line":47,"column":29},"end":{"line":47,"column":30}},"loc":{"start":{"line":47,"column":43},"end":{"line":82,"column":5}},"line":47},"17":{"name":"(anonymous_17)","decl":{"start":{"line":60,"column":42},"end":{"line":60,"column":43}},"loc":{"start":{"line":60,"column":58},"end":{"line":60,"column":93}},"line":60}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":38,"column":22},"end":{"line":40,"column":1}},"type":"binary-expr","locations":[{"start":{"line":38,"column":23},"end":{"line":38,"column":27}},{"start":{"line":38,"column":31},"end":{"line":38,"column":51}},{"start":{"line":38,"column":56},"end":{"line":40,"column":1}}],"line":38},"30":{"loc":{"start":{"line":39,"column":11},"end":{"line":39,"column":61}},"type":"cond-expr","locations":[{"start":{"line":39,"column":37},"end":{"line":39,"column":40}},{"start":{"line":39,"column":43},"end":{"line":39,"column":61}}],"line":39},"31":{"loc":{"start":{"line":39,"column":12},"end":{"line":39,"column":33}},"type":"binary-expr","locations":[{"start":{"line":39,"column":12},"end":{"line":39,"column":15}},{"start":{"line":39,"column":19},"end":{"line":39,"column":33}}],"line":39},"32":{"loc":{"start":{"line":48,"column":8},"end":{"line":81,"column":9}},"type":"switch","locations":[{"start":{"line":49,"column":12},"end":{"line":52,"column":29}},{"start":{"line":53,"column":12},"end":{"line":56,"column":99}},{"start":{"line":57,"column":12},"end":{"line":65,"column":29}},{"start":{"line":66,"column":12},"end":{"line":66,"column":44}},{"start":{"line":67,"column":12},"end":{"line":71,"column":40}},{"start":{"line":72,"column":12},"end":{"line":79,"column":42}},{"start":{"line":80,"column":12},"end":{"line":80,"column":42}}],"line":48},"33":{"loc":{"start":{"line":55,"column":16},"end":{"line":55,"column":52}},"type":"if","locations":[{"start":{"line":55,"column":16},"end":{"line":55,"column":52}},{"start":{"line":55,"column":16},"end":{"line":55,"column":52}}],"line":55},"34":{"loc":{"start":{"line":61,"column":16},"end":{"line":64,"column":17}},"type":"if","locations":[{"start":{"line":61,"column":16},"end":{"line":64,"column":17}},{"start":{"line":61,"column":16},"end":{"line":64,"column":17}}],"line":61},"35":{"loc":{"start":{"line":73,"column":16},"end":{"line":78,"column":17}},"type":"if","locations":[{"start":{"line":73,"column":16},"end":{"line":78,"column":17}},{"start":{"line":73,"column":16},"end":{"line":78,"column":17}}],"line":73}},"s":{"0":1,"1":1,"2":1,"3":2,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":3,"11":2,"12":1,"13":2,"14":1,"15":0,"16":1,"17":2,"18":0,"19":6,"20":3,"21":3,"22":0,"23":3,"24":13,"25":13,"26":0,"27":13,"28":0,"29":13,"30":3,"31":3,"32":1,"33":1,"34":0,"35":0,"36":0,"37":0,"38":2,"39":2,"40":2,"41":7,"42":2,"43":2,"44":5,"45":3,"46":3,"47":2,"48":0,"49":0,"50":0,"51":2,"52":2,"53":2,"54":2,"55":0,"56":0,"57":0,"58":0,"59":8,"60":0,"61":0,"62":13,"63":2,"64":0,"65":2,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":2,"74":2,"75":8,"76":2,"77":2,"78":2,"79":2,"80":2,"81":1,"82":1,"83":1,"84":1,"85":1,"86":2,"87":1,"88":1,"89":1,"90":1,"91":2,"92":0,"93":0,"94":0,"95":0,"96":2,"97":1,"98":1,"99":2,"100":2,"101":1},"f":{"0":2,"1":1,"2":1,"3":2,"4":1,"5":0,"6":3,"7":2,"8":1,"9":0,"10":6,"11":3,"12":3,"13":1,"14":2,"15":2,"16":8,"17":2},"b":{"0":[1,1,1],"1":[0,1],"2":[2,2],"3":[2,1],"4":[2,2],"5":[1,1,1],"6":[0,1],"7":[2,2],"8":[0,3],"9":[0,13],"10":[13,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,13],"16":[3,3,1,0,2,7],"17":[2,5],"18":[7,4,4],"19":[7,3],"20":[3,2],"21":[5,5,3,3],"22":[0,2],"23":[2,0],"24":[2,0],"25":[2,2],"26":[0,0],"27":[0,2],"28":[2,0],"29":[1,1,1],"30":[0,1],"31":[1,1],"32":[2,2,1,2,0,2,2],"33":[1,1],"34":[1,0],"35":[1,1]},"inputSourceMap":{"version":3,"file":"/home/matan/code/workshops/sep23/express/middlewares/authenticateRequest.ts","sources":["/home/matan/code/workshops/sep23/express/middlewares/authenticateRequest.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,8DAA8B;AAC9B,uCAAiD;AAE1C,IAAM,mBAAmB,GAAG,UAAO,GAAY,EAAE,GAAa,EAAE,IAAkB;;;;;gBAC/E,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC;gBACpC,KAAK,GAAG,KAAK,CAAC;;;;qBAEV,KAAK,EAAL,wBAAK;gBACa,qBAAM,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,EAAA;;gBAA3D,SAAS,GAAG,SAA+C;gBAC3D,SAAO,cAAO,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,EAAC,GAAG,EAAE,IAAI,EAAC,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;gBAC1D,IAAI,GAAG,aAAM,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,GAAG,KAAK,MAAI,CAAC,GAAG,EAArB,CAAqB,CAAC,CAAC;gBACxD,IAAI,IAAI,EAAE;oBACN,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC;oBAChB,KAAK,GAAG,IAAI,CAAC;iBAChB;;;;;gBAGL,OAAO,CAAC,GAAG,CAAC,KAAG,CAAC,CAAA;gBAChB,KAAK,GAAG,KAAK,CAAC;;;gBAEd,IAAI,KAAK,EAAE;oBACP,IAAI,EAAE,CAAC;iBACV;qBAAM;oBACH,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,cAAc,EAAE,CAAC,CAAC;iBACrD;;;;;KAER,CAAA;AAvBY,QAAA,mBAAmB,uBAuB/B","sourcesContent":["import { NextFunction, Request, Response } from \"express\";\nimport jwt from 'jsonwebtoken'\nimport { UserZod, UserDB } from '../models/User';\n\nexport const authenticateRequest = async (req: Request, res: Response, next: NextFunction) => {\n    const token = req.headers.authorization;\n    let valid = false;\n    try{\n        if (token) {\n            const tokenBody = await jwt.verify(token, process.env.JWT_SECRET)\n            const body = UserZod.strip().pick({_id: true}).parse(tokenBody);\n            const user = UserDB.find(user => user._id === body._id);\n            if (user) {\n                req.user = user;\n                valid = true;\n            }\n        }\n    }catch(err){\n        console.log(err)\n        valid = false;\n    }finally{\n        if (valid) {\n            next();\n        } else {\n            res.status(401).json({ message: 'Unauthorized' });\n        }\n    }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c8d83f7b0c50fe66d1a3de00f2594bf87769c87e","contentHash":"ed6d3b0b26ff476a4953f074c6b87ea08b94ef9cb491e888d9ff29a611e871db"}}